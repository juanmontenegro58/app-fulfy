(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-53c92864"],{"083a":function(t,e,r){"use strict";var n=r("0d51"),c=TypeError;t.exports=function(t,e){if(!delete t[e])throw c("Cannot delete property "+n(e)+" of "+n(t))}},"129f":function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t===1/e:t!=t&&e!=e}},6816:function(t,e,r){"use strict";r.d(e,"b",(function(){return u})),r.d(e,"a",(function(){return d})),r.d(e,"d",(function(){return l})),r.d(e,"c",(function(){return p}));var n,c,a,o,s=r("8785"),i=r("5184"),u=Object(i["a"])(n||(n=Object(s["a"])(["mutation deleteProduct($id: ID!){\n    deleteProduct(id: $id){\n        success\n    }\n}"]))),d=Object(i["a"])(c||(c=Object(s["a"])(["mutation createProduct($product: ProductCreateInput!){\n    createProduct(product: $product){\n        product{\n            id \n            name \n            image \n            sku\n        }\n    }\n}\n"]))),l=Object(i["a"])(a||(a=Object(s["a"])(["mutation updateProduct($product: ProductEditInput!, $id: ID!){\n    updateProduct(product: $product, id: $id){\n        product{\n            updated\n            name\n            sku\n            id\n        }\n    }\n}"]))),p=Object(i["a"])(o||(o=Object(s["a"])(["query getProduct($sku: String!){\n    getProduct(sku: $sku){\n        name\n        id\n        price\n        category{\n            id\n        }\n        store{\n            id\n        }\n        active\n        stock\n    }\n}"])))},"841c":function(t,e,r){"use strict";var n=r("c65b"),c=r("d784"),a=r("825a"),o=r("1d80"),s=r("129f"),i=r("577e"),u=r("dc4a"),d=r("14c3");c("search",(function(t,e,r){return[function(e){var r=o(this),c=void 0==e?void 0:u(e,t);return c?n(c,e,r):new RegExp(e)[t](i(r))},function(t){var n=a(this),c=i(t),o=r(e,n,c);if(o.done)return o.value;var u=n.lastIndex;s(u,0)||(n.lastIndex=0);var l=d(n,c);return s(n.lastIndex,u)||(n.lastIndex=u),null===l?-1:l.index}]}))},"8fbd":function(t,e,r){"use strict";r.d(e,"a",(function(){return s})),r.d(e,"b",(function(){return i}));var n,c,a=r("8785"),o=r("5184"),s=Object(o["a"])(n||(n=Object(a["a"])(["query listProducts($cursor: String, $productName: String){\n    listProducts(after: $cursor, name_Icontains: $productName){\n        pageInfo{\n            hasNextPage\n        }\n        edges{\n            cursor\n            node{\n                name\n                id\n                stock\n                price\n                sku\n                store{\n                    name\n                }\n            }\n        }\n    }\n}"]))),i=Object(o["a"])(c||(c=Object(a["a"])(["query productsLowStock($store: Int){\n    productsLowStock(store: $store){\n        stock\n        product\n        store\n        id\n    }\n}"])))},a434:function(t,e,r){"use strict";var n=r("23e7"),c=r("7b0b"),a=r("23cb"),o=r("5926"),s=r("07fa"),i=r("3511"),u=r("65f0"),d=r("8418"),l=r("083a"),p=r("1dde"),b=p("splice"),f=Math.max,m=Math.min;n({target:"Array",proto:!0,forced:!b},{splice:function(t,e){var r,n,p,b,h,v,g=c(this),k=s(g),P=a(t,k),x=arguments.length;for(0===x?r=n=0:1===x?(r=0,n=k-P):(r=x-2,n=m(f(o(e),0),k-P)),i(k+r-n),p=u(g,n),b=0;b<n;b++)h=P+b,h in g&&d(p,b,g[h]);if(p.length=n,r<n){for(b=P;b<k-n;b++)h=b+n,v=b+r,h in g?g[v]=g[h]:l(g,v);for(b=k;b>k-n+r;b--)l(g,b-1)}else if(r>n)for(b=k-n;b>P;b--)h=b+n-1,v=b+r-1,h in g?g[v]=g[h]:l(g,v);for(b=0;b<r;b++)g[b+P]=arguments[b+2];return g.length=k-n+r,p}})},b687:function(t,e,r){"use strict";r.r(e);r("ac1f"),r("841c"),r("b0c0");var n=function(){var t=this,e=t._self._c;return e("layout",[e("page-header",{attrs:{title:t.title}}),[e("div",[e("b-card",{staticClass:"mb-2"},[e("b-card-text",[e("b-col",{attrs:{lg:"4",md:"4"}},[e("b-form",{staticClass:"mb-3",on:{submit:function(t){t.preventDefault()}}},[e("b-form-group",[e("b-input-group",[e("b-form-input",{attrs:{id:"input-1",type:"text",placeholder:"Buscar por nombre",required:""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}}),e("b-input-group-append",[e("b-button",{attrs:{type:"submit",disabled:!t.search},on:{click:function(e){return t.getProducts(!0)}}},[t._v("Buscar")])],1)],1)],1)],1)],1),t.loadingProducts?[e("b-skeleton-table",{attrs:{rows:10,columns:4,"table-props":{bordered:!0,striped:!0}}})]:[e("div",{staticClass:"table-responsive"},[e("b-table",{attrs:{striped:"",hover:"",items:t.products,fields:t.fields,responsive:"sm"},scopedSlots:t._u([{key:"cell(stock)",fn:function(e){var r=e.item;return[t._v(" "+t._s(t.formatPriceNumber(r.stock,null))+" ")]}},{key:"cell(price)",fn:function(e){var r=e.item;return[t._v(" "+t._s(t.formatPriceNumber(r.price,"currency"))+" ")]}},{key:"cell(actions)",fn:function(r){var n=r.item;return[t.can("change_product")?e("router-link",{staticClass:"btn btn-primary",staticStyle:{"margin-right":"2px"},attrs:{to:{name:"update-product",params:{sku:n.sku}}}},[e("i",{staticClass:"mdi mdi-book-edit"})]):t._e(),t.can("delete_product")?e("b-btn",{staticStyle:{"margin-right":"2px"},attrs:{variant:"danger"},on:{click:function(e){return t.deleteProduct(n.id,n.name)}}},[e("i",{staticClass:"mdi mdi-delete"})]):t._e(),e("b-btn",{directives:[{name:"b-modal",rawName:"v-b-modal.showProduct",modifiers:{showProduct:!0}}],attrs:{variant:"success"},on:{click:function(e){return t.viewProduct(n.id)}}},[e("i",{staticClass:"mdi mdi-eye"})])]}}])})],1)]],2)],1),t.hasNextPage?e("div",{staticClass:"text-center mt-2"},[e("b-button",{attrs:{block:"",variant:"primary"},on:{click:function(e){return t.getProducts()}}},[t._v(" Ver más ")])],1):t._e()],1)],t.selectedProduct?e("b-modal",{attrs:{id:"showProduct",title:t.selectedProduct.name,"ok-only":"","ok-title":"Aceptar",size:"lg"}},[e("div",{staticClass:"text-center",attrs:{id:"bar-code"}},[e("barcode",{attrs:{value:t.selectedProduct.sku,format:"",width:"1",fontOptions:"italic"}})],1),e("div",{staticClass:"text-center"},[e("b-button",{on:{click:t.printBarCode}},[t._v(" Descargar el código de barras ")])],1)]):t._e()],2)},c=[],a=r("b85c"),o=r("c7eb"),s=r("1da1"),i=(r("1276"),r("c740"),r("a434"),r("444f")),u=r("2579"),d=r("8fbd"),l=r("6816"),p=r("154f"),b=r("9b8d"),f=r("f579"),m=r.n(f),h=r("3d20"),v=r.n(h),g=r("9475"),k={mixins:[g["a"]],components:{Layout:i["a"],PageHeader:u["a"],barcode:m.a},data:function(){return{title:"Productos",products:[],hasNextPage:null,lastCursor:null,loadingProducts:!0,fields:[{key:"name",label:"Producto"},{key:"storeName",label:"Tienda"},{key:"stock"},{key:"price",label:"Precio"},{key:"actions",label:"Acciones"}],search:null,selectedProduct:null}},watch:{search:function(t){""===t&&(this.products=[],this.lastCursor=null,this.getProducts())}},methods:{getProducts:function(){var t=arguments,e=this;return Object(s["a"])(Object(o["a"])().mark((function r(){var n,c,a,s;return Object(o["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n=t.length>0&&void 0!==t[0]&&t[0],e.loadingProducts=!0,!0===n&&(e.products=[],e.lastCursor=null),r.prev=3,r.next=6,e.$apollo.query({query:d["a"],variables:{cursor:e.lastCursor,productName:e.search}});case 6:c=r.sent,a=c.data.listProducts,null!==a&&(s=a.edges,e.hasNextPage=a.pageInfo.hasNextPage,e.formatDataTable(s)),e.loadingProducts=!1,r.next=16;break;case 12:r.prev=12,r.t0=r["catch"](3),e.loadingProducts=!1,Object(b["b"])("error","No se pudo recuperar la información");case 16:case"end":return r.stop()}}),r,null,[[3,12]])})))()},formatDataTable:function(t){var e,r=Object(a["a"])(t);try{for(r.s();!(e=r.n()).done;){var n=e.value,c=n.node,o={id:c.id,name:c.name,storeName:c.store.name,price:c.price,stock:c.stock,sku:c.sku};this.products.push(o),this.lastCursor=n.cursor}}catch(s){r.e(s)}finally{r.f()}},formatPriceNumber:function(t,e){return Object(p["g"])(t,e)},deleteProductMutate:function(t){var e=this;return Object(s["a"])(Object(o["a"])().mark((function r(){var n,c,a;return Object(o["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n=Object(p["a"])(t).split(":")[1],r.prev=1,r.next=4,e.$apollo.mutate({mutation:l["b"],variables:{id:n}});case 4:if(c=r.sent,a=c.data.deleteProduct,null===a){r.next=8;break}return r.abrupt("return",a.success);case 8:r.next=13;break;case 10:return r.prev=10,r.t0=r["catch"](1),r.abrupt("return",!1);case 13:case"end":return r.stop()}}),r,null,[[1,10]])})))()},deleteProduct:function(t,e){var r=this;v.a.fire({title:"¿Estas seguro?",text:'Archivar producto: "'.concat(e,'"'),icon:"question",showCancelButton:!0,confirmButtonText:"Si, Archivar",confirmButtonColor:"#bb2d3b",cancelButtonText:"No, cancelar",cancelButtonColor:"",showLoaderOnConfirm:!0,preConfirm:function(){return r.deleteProductMutate(t).then((function(n){if(!0===n){var c=r.products.findIndex((function(e){return e.id==t}));r.products.splice(c,1),Object(b["a"])("Archivado!",'El producto "'.concat(e,'" ha sido archivado con exito.'),"success")}else Object(b["a"])("","No se ha podido completar la operación","error")})).catch((function(t){v.a.showValidationMessage("No se ha podido completar la operación")}))},allowOutsideClick:!1,allowEscapeKey:!1})},viewProduct:function(t){var e=this.products.findIndex((function(e){return e.id===t}));this.selectedProduct=this.products[e]},printBarCode:function(){var t=document.getElementById("bar-code"),e=window.open();e.document.write(t.innerHTML),e.document.close(),e.print(),e.close()}},beforeMount:function(){this.getProducts()}},P=k,x=r("2877"),w=Object(x["a"])(P,n,c,!1,null,null,null);e["default"]=w.exports}}]);
//# sourceMappingURL=chunk-53c92864.25f8b1a6.js.map