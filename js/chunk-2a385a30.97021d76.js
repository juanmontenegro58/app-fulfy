(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2a385a30"],{"083a":function(e,t,a){"use strict";var n=a("0d51"),r=TypeError;e.exports=function(e,t){if(!delete e[t])throw r("Cannot delete property "+n(t)+" of "+n(e))}},"08c1":function(e,t,a){"use strict";a.d(t,"b",(function(){return u})),a.d(t,"a",(function(){return c})),a.d(t,"c",(function(){return d}));var n,r,i,s=a("8785"),o=a("5184"),u=Object(o["a"])(n||(n=Object(s["a"])(["query getGuideLocal($after: String, $createdGte: DateTime, $createdLte: DateTime, $guideNumber: String, $status: String, $name: String){\n    guidesLocal(after: $after, created_Date_Gte: $createdGte, created_Date_Lte: $createdLte, guideNumber_Icontains: $guideNumber, status_Iexact: $status, name_Icontains: $name){\n        pageInfo{\n            hasNextPage\n            endCursor\n            startCursor\n        }\n        edges{\n            cursor\n            node{\n                id\n                address\n                phoneNumber\n                city\n                name\n                customerAnnotations\n                guideNumber\n                store{\n                    name\n                    email\n                    phoneNumber\n                }\n                userCreated{\n                    firstName\n                    lastName\n                }\n                status\n                created\n                guidelocalproductthroughSet{\n                    edges{\n                        node{\n                            quantity\n                            product{\n                                name\n                            }\n                            price\n                            productObservations\n                        }\n                    }\n                }\n            }\n        }\n    }\n}"]))),c=Object(o["a"])(r||(r=Object(s["a"])(["query getGuideLocal($after: String, $createdGte: DateTime, $createdLte: DateTime, $guideNumber: String, $status: String, $name: String){\n    guidesLocal(after: $after, created_Date_Gte: $createdGte, created_Date_Lte: $createdLte, guideNumber_Icontains: $guideNumber, status_Iexact: $status, name_Icontains: $name){\n        pageInfo{\n            hasNextPage\n        }\n        edges{\n            cursor\n            node{\n                guideNumber\n                guidelocalproductthroughSet{\n                    edges{\n                        node{\n                            quantity\n                            product{\n                                name\n                                sku\n                                id\n                            }\n                            price\n                            productObservations\n                        }\n                    }\n                }\n            }\n        }\n    }\n}"]))),d=Object(o["a"])(i||(i=Object(s["a"])(["query getGuideLocal($createdGte: DateTime, $createdLte: DateTime, $guideNumber: String,\n    $status: String, $name: String){\n        guidesLocalDispatch(created_Date_Gte: $createdGte, created_Date_Lte: $createdLte, status_Iexact: $status, guideNumber_Icontains: $guideNumber, name_Icontains: $name){\n              pageInfo{\n                hasNextPage\n                endCursor\n                startCursor\n            }\n            edges{\n                cursor\n                node{\n                    id\n                    address\n                    city\n                    name\n                    customerAnnotations\n                    guideNumber\n                    phoneNumber\n                    store{\n                        name\n                        email\n                        phoneNumber\n                    }\n                    userCreated{\n                        firstName\n                        lastName\n                    }\n                    status\n                    created\n                    guidelocalproductthroughSet{\n                        edges{\n                            node{\n                                quantity\n                                product{\n                                    name\n                                    sku\n                                }\n                                price\n                                productObservations\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    }"])))},3835:function(e,t,a){"use strict";function n(e){if(Array.isArray(e))return e}a.d(t,"a",(function(){return o}));a("a4d3"),a("e01a"),a("d3b7"),a("d28b"),a("3ca3"),a("ddb0");function r(e,t){var a=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var n,r,i=[],s=!0,o=!1;try{for(a=a.call(e);!(s=(n=a.next()).done);s=!0)if(i.push(n.value),t&&i.length===t)break}catch(u){o=!0,r=u}finally{try{s||null==a["return"]||a["return"]()}finally{if(o)throw r}}return i}}var i=a("06c5");a("d9e2");function s(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function o(e,t){return n(e)||r(e,t)||Object(i["a"])(e,t)||s()}},4296:function(e,t,a){},7493:function(e,t,a){"use strict";a.r(t);a("b0c0");var n=function(){var e=this,t=e._self._c;return t("layout",[t("page-header",{attrs:{title:e.title}}),t("b-card",[t("b-card-text",[t("b-row",[t("b-col",{attrs:{md:"4"}},[t("b-form-group",{staticClass:"mb-2"},[t("b-form-datepicker",{attrs:{placeholder:"Fecha Inicial",max:e.maxDate},model:{value:e.startDate,callback:function(t){e.startDate=t},expression:"startDate"}})],1)],1),t("b-col",{attrs:{md:"4"}},[t("b-form-group",{staticClass:"mb-2"},[t("b-form-datepicker",{attrs:{placeholder:"Fecha Final",max:e.maxDate,min:e.minEndDate},model:{value:e.endDate,callback:function(t){e.endDate=t},expression:"endDate"}})],1)],1),t("b-col",{attrs:{md:"1"}},[t("b-button",{attrs:{disabled:null===e.startDate||null===e.endDate,variant:"success"},on:{click:function(t){return e.getGuidesLocal(!0)}}},[e._v(" Enviar ")])],1),t("b-col",{attrs:{md:"1"}},[t("b-button",{directives:[{name:"show",rawName:"v-show",value:e.startDate&&e.endDate,expression:"startDate && endDate"}],attrs:{variant:"info"},on:{click:function(t){return e.clearDates()}}},[e._v(" Limpiar ")])],1)],1),t("b-row",[t("b-col",{attrs:{lg:"4",md:"4"}},[t("b-form",{staticClass:"mb-3",on:{submit:function(e){e.preventDefault()}}},[t("b-form-group",[t("b-input-group",[t("b-form-input",{attrs:{id:"input-1",type:"text",placeholder:"Buscar por número de guía",required:""},model:{value:e.searchGuide,callback:function(t){e.searchGuide=t},expression:"searchGuide"}}),t("b-input-group-append",[t("b-button",{attrs:{type:"submit",disabled:!e.searchGuide,variant:"warning"},on:{click:function(t){return e.getGuidesLocal(!0)}}},[e._v("Buscar")])],1)],1)],1)],1)],1),t("b-col",{attrs:{lg:"4",md:"4"}},[t("b-form",{staticClass:"mb-3",on:{submit:function(e){e.preventDefault()}}},[t("b-form-group",[t("b-input-group",[t("b-form-input",{attrs:{type:"text",placeholder:"Buscar por destinatario",required:""},model:{value:e.nameDestinatario,callback:function(t){e.nameDestinatario=t},expression:"nameDestinatario"}}),t("b-input-group-append",[t("b-button",{attrs:{type:"submit",disabled:!e.nameDestinatario,variant:"warning"},on:{click:function(t){return e.getGuidesLocal(!0)}}},[e._v("Buscar")])],1)],1)],1)],1)],1),e.startDate&&e.endDate?t("b-col",{attrs:{md:"1","offset-md":"3"}},[t("print-guide-local",{attrs:{startDate:e.startDate,endDate:e.endDate}})],1):e._e()],1),e.loadingGuides?[t("b-skeleton-table",{attrs:{rows:10,columns:6,"table-props":{bordered:!0,striped:!0}}})]:[t("div",{staticClass:"table-responsive"},[t("b-table",{attrs:{striped:"",hover:"",items:e.guidesTable,fields:e.fields,responsive:"sm"},scopedSlots:e._u([{key:"cell(status)",fn:function(t){var a=t.item;return[e._v(" "+e._s(e.getStatusGuideLocal(a.status))+" ")]}},{key:"cell(actions)",fn:function(a){var n=a.item;return[t("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-lg",modifiers:{"modal-lg":!0}}],attrs:{variant:"primary",size:"sm"},on:{click:function(t){return e.searchGuideLocal(n.guideNumber)}}},[t("i",{staticClass:"mdi mdi-eye"})]),t("b-button",{staticStyle:{"margin-left":"1px"},attrs:{variant:"danger",size:"sm",disabled:"CAN"===n.status||"ANU"===n.status||"IMP"===n.status||"DES"==n.status},on:{click:function(t){return e.modalQuestionCancel(n.guideNumber)}}},[t("i",{staticClass:"mdi mdi-cancel"})])]}}])})],1)]],2),e.hasNextPage?t("div",{staticClass:"text-center mt-2"},[t("b-button",{attrs:{block:"",variant:"primary",disabled:e.loadingMore},on:{click:function(t){return e.getGuidesLocal()}}},[e.loadingMore?[t("b-spinner",{attrs:{small:"",type:"grow"}}),e._v(" Cargando... ")]:[e._v(" Ver más ")]],2)],1):e._e()],1),e.guideLocalSelect?t("b-modal",{attrs:{id:"modal-lg",size:"lg",title:"Guía Número ".concat(e.guideLocalSelect.guideNumber),"no-close-on-backdrop":!0,"no-close-on-esc":!0,"ok-only":""}},[t("p",{staticClass:"text_right"},[e._v(e._s(e.guideLocalSelect.created))]),t("div",{staticClass:"text-center"},[t("barcode",{attrs:{value:e.guideLocalSelect.guideNumber,"display-value":!1,format:"",width:"1",height:"60"}})],1),t("b-row",e._l(e.guideLocalSelect.products,(function(a,n){return t("div",{key:n,staticClass:"col-md-6"},[t("b-card",[t("b-card-text",[t("strong",[e._v(e._s(a.node.product.name)+":")]),e._v(" "+e._s(a.node.quantity)+" uds. ($"+e._s(e.formatPriceString(a.node.price))+") "),t("p",{staticStyle:{"font-size":"x-small"}},[e._v(" "+e._s(a.node.productObservations)+" ")])])],1)],1)})),0)],1):e._e()],1)},r=[],i=a("5530"),s=a("b85c"),o=a("c7eb"),u=a("1da1"),c=(a("ac1f"),a("1276"),a("99af"),a("c740"),a("a434"),a("444f")),d=a("2579"),l=a("08c1"),b=a("8036"),m=a("9b8d"),f=a("154f"),g=a("f579"),p=a.n(g),h=function(){var e=this,t=e._self._c;return t("div",[t("vue-html2pdf",{ref:"html2Pdf",attrs:{"show-layout":!1,"float-layout":!0,"enable-download":!0,"preview-modal":!0,filename:"RelaciónDespacho","pdf-quality":2,"manual-pagination":!0,"pdf-format":"a4","pdf-orientation":"landscape","pdf-content-width":"1100px "},on:{progress:function(t){return e.onProgress(t)}}},e._l(e.items,(function(n,r){return t("section",{key:r,staticStyle:{"margin-top":"0px"},attrs:{slot:"pdf-content"},slot:"pdf-content"},[t("div",{staticClass:"container-pdf"},[t("section",{attrs:{id:"header"}},[t("div",{staticClass:"row"},[t("div",{staticClass:"col-md-6"},[t("img",{staticClass:"logo",attrs:{src:a("b260"),alt:"..."}})])])]),t("section",{staticClass:"text-center",staticStyle:{"font-size":"small",margin:"2em",border:"1px solid gray"},attrs:{id:"body"}},[t("b-table",{attrs:{striped:"",bordered:"",fields:e.fields,items:n,small:!0},scopedSlots:e._u([{key:"cell(id)",fn:function(a){var n=a.item;return[t("p",[e._v(e._s(n.id))])]}},{key:"cell(address)",fn:function(a){var n=a.item;return[t("p",{staticStyle:{"font-size":"10px"}},[e._v(e._s(n.address))])]}},{key:"cell(products)",fn:function(a){var n=a.item;return[t("p",{domProps:{innerHTML:e._s(n.products)}})]}},{key:"cell(barCode)",fn:function(e){var a=e.item;return[t("barcode",{attrs:{value:a.guideNumber,"display-value":!1,format:"",width:"1",height:"17"}})]}}],null,!0)})],1),r!==e.items.length-1?t("div",{staticClass:"html2pdf__page-break"}):e._e()])])})),0),t("div",[t("button",{staticClass:"btn btn-success",attrs:{disabled:e.creating},on:{click:function(t){return e.getGuidesLocal()}}},[e.creating?[t("b-spinner",{attrs:{small:""}})]:[t("i",{staticClass:"mdi mdi-printer"})]],2)])],1)},v=[],y=a("3835"),D=(a("d3b7"),a("ddb0"),a("6480")),N={components:{VueHtml2pdf:D["a"],barcode:p.a},props:{startDate:{type:String,required:!0},endDate:{type:String,required:!0}},data:function(){return{creating:!1,fields:[{key:"id",label:"#"},{key:"guideNumber",label:"Nº Guía"},{key:"name",label:"Destinatario"},{key:"phoneNumber",label:"Celular"},{key:"address",label:"Dirección"},{key:"products",label:"Producto"},{key:"value",label:"Valor"},{key:"barCode",label:"Código barras"}],items:[],limitCell:5}},methods:{generateReport:function(){this.$refs.html2Pdf.generatePdf()},onProgress:function(e){100===e&&(this.creating=!1,this.items=[])},getGuidesLocal:function(){var e=this;return Object(u["a"])(Object(o["a"])().mark((function t(){var a,n,r;return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.creating=!0,t.prev=1,t.next=4,e.$apollo.query({query:l["c"],variables:{status:"DES",createdGte:new Date(e.startDate),createdLte:new Date(e.endDate)}});case 4:if(a=t.sent,n=a.data.guidesLocalDispatch,null!==n){t.next=8;break}return t.abrupt("return",Object(m["b"])("error","No se pudo recuperar la información"));case 8:return r=n.edges,e.formatData(r),e.generateReport(),t.abrupt("return",!0);case 14:return t.prev=14,t.t0=t["catch"](1),e.creating=!1,t.abrupt("return",Object(m["b"])("error","No se pudo recuperar la información"));case 18:case"end":return t.stop()}}),t,null,[[1,14]])})))()},formatData:function(e){var t,a=[],n=Object(s["a"])(e.entries());try{for(n.s();!(t=n.n()).done;){var r=Object(y["a"])(t.value,2),i=r[0],o=r[1],u={id:i+1,address:o.node.address,products:this.formatProductToString(o.node.guidelocalproductthroughSet.edges),name:o.node.name,guideNumber:o.node.guideNumber,phoneNumber:o.node.phoneNumber,value:"$".concat(Object(f["g"])(this.sumValueGuide(o.node.guidelocalproductthroughSet.edges)))};a.length<this.limitCell?(a.push(u),i===e.length-1&&this.items.push(a)):(this.items.push(a),a=[],a.push(u),i===e.length-1&&this.items.push(a),i++)}}catch(c){n.e(c)}finally{n.f()}},sumValueGuide:function(e){var t,a=0,n=Object(s["a"])(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;a+=r.node.price}}catch(i){n.e(i)}finally{n.f()}return a},formatProductToString:function(e){var t,a='<ul style="padding: 0; margin-left: 10px; list-style: none;">',n=Object(s["a"])(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;a+="<li>".concat(r.node.product.name," X ").concat(r.node.quantity,"</li>")}}catch(i){n.e(i)}finally{n.f()}return a+="</ul>",a}}},k=N,x=(a("c54a"),a("2877")),_=Object(x["a"])(k,h,v,!1,null,"609e9665",null),C=_.exports,G=a("3d20"),w=a.n(G),S={name:"ListGuides",components:{PageHeader:d["a"],Layout:c["a"],barcode:p.a,printGuideLocal:C},data:function(){var e=new Date,t=new Date(e.getFullYear(),e.getMonth(),e.getDate());return{title:"Guías locales",loadingGuides:!0,hasNextPage:!1,loadingMore:!1,fields:[{key:"id",label:"ID"},{key:"guideNumber",label:"Guía"},{key:"name",label:"Destinatario"},{key:"status",label:"Estado"},{key:"store",label:"Tienda"},{key:"products",label:"Productos"},{key:"user",label:"Usuario"},{key:"created",label:"Fecha creación"},{key:"actions",label:"Acciones"}],guidesTable:[],guidesDetail:[],guideLocalSelect:null,endCursor:null,searchGuide:null,startDate:null,endDate:null,maxDate:t,minEndDate:null,nameDestinatario:null}},watch:{searchGuide:function(e){""===e&&this.resetInfoSearch()},startDate:function(e){this.startDate>this.endDate&&(this.endDate=this.startDate);var t=new Date(this.startDate),a=new Date(t.getFullYear(),t.getMonth(),t.getDate()+1);this.minEndDate=a},nameDestinatario:function(e){""===e&&this.resetInfoSearch()}},methods:{resetInfoSearch:function(){this.guidesTable=[],this.endCursor=null,this.loadingGuides=!0,this.getGuidesLocal()},getGuidesLocal:function(){var e=arguments,t=this;return Object(u["a"])(Object(o["a"])().mark((function a(){var n,r,i,s;return Object(o["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=e.length>0&&void 0!==e[0]&&e[0],!0===n&&(t.loadingGuides=!0,t.guidesTable=[],t.endCursor=null),t.loadingMore=!0,a.prev=3,a.next=6,t.$apollo.query({query:l["b"],variables:{after:t.endCursor,guideNumber:t.searchGuide,createdGte:null!==t.startDate?new Date(t.startDate):null,createdLte:null!==t.endDate?new Date(t.endDate):null,name:t.nameDestinatario}});case 6:if(r=a.sent,i=r.data.guidesLocal,null!==i){a.next=12;break}return t.loadingGuides=!1,t.loadingMore=!1,a.abrupt("return",Object(m["b"])("error","No se pudo recuperar la información"));case 12:return s=i.edges,t.hasNextPage=i.pageInfo.hasNextPage,t.endCursor=i.pageInfo.endCursor,t.formatDataTable(s),t.loadingGuides=!1,t.loadingMore=!1,a.abrupt("return",!0);case 21:return a.prev=21,a.t0=a["catch"](3),t.loadingGuides=!1,t.loadingMore=!1,a.abrupt("return",Object(m["b"])("error","Error al recuperar la información"));case 26:case"end":return a.stop()}}),a,null,[[3,21]])})))()},formatDataTable:function(e){var t,a=Object(s["a"])(e);try{for(a.s();!(t=a.n()).done;){var n=t.value,r={id:Object(f["a"])(n.node.id).split(":")[1],guideNumber:n.node.guideNumber,name:n.node.name,store:n.node.store.name,status:n.node.status,products:this.sumQuantityProducts(n.node.guidelocalproductthroughSet.edges),user:"".concat(n.node.userCreated.firstName," ").concat(n.node.userCreated.lastName),created:Object(f["e"])(n.node.created,!0)},i={guideNumber:n.node.guideNumber,products:n.node.guidelocalproductthroughSet.edges,created:Object(f["d"])(n.node.created,!0)};this.guidesTable.push(r),this.guidesDetail.push(i)}}catch(o){a.e(o)}finally{a.f()}},sumQuantityProducts:function(e){var t,a=0,n=Object(s["a"])(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;a+=r.node.quantity}}catch(i){n.e(i)}finally{n.f()}return a},searchGuideLocal:function(e){var t=this.guidesDetail.findIndex((function(t){return t.guideNumber===e}));-1!==t&&(this.guideLocalSelect=this.guidesDetail[t])},formatPriceString:function(e){return Object(f["g"])(e)},clearDates:function(){this.startDate=null,this.endDate=null,this.guidesTable=[],this.endCursor=null,this.hasNextPage=null,this.loadingGuides=!0,this.getGuidesLocal()},getStatusGuideLocal:function(e){var t={ENT:"Entregado",CAN:"Cancelado",CRE:"Creado",DES:"En despacho",ANU:"Anulado",IMP:"Impreso"};return t[e]},modalQuestionCancel:function(e){var t=this;w.a.fire({title:"¿Estas seguro?",text:'Anular guía Nº: "'.concat(e,'"'),icon:"question",showCancelButton:!0,confirmButtonText:"Si, continuar",confirmButtonColor:"#bb2d3b",cancelButtonText:"No, cancelar",cancelButtonColor:"",showLoaderOnConfirm:!0,preConfirm:function(){return t.cancelGuide(e)},allowOutsideClick:!1,allowEscapeKey:!1})},cancelGuide:function(e){var t=this;return Object(u["a"])(Object(o["a"])().mark((function a(){var n,r;return Object(o["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,t.$apollo.mutate({mutation:b["d"],variables:{guideNumber:e}});case 3:if(n=a.sent,r=n.data.revokeGuide,null!==r){a.next=7;break}return a.abrupt("return",Object(m["b"])("error","No se pudo anular la guía."));case 7:if(!r.success){a.next=10;break}return t.updateRowCancel(e),a.abrupt("return",Object(m["b"])("success","Guía anulada con exito."));case 10:a.next=15;break;case 12:return a.prev=12,a.t0=a["catch"](0),a.abrupt("return",Object(m["b"])("error","No se pudo anular la guía"));case 15:case"end":return a.stop()}}),a,null,[[0,12]])})))()},updateRowCancel:function(e){var t=this.guidesTable.findIndex((function(t){return t.guideNumber===e})),a=this.guidesTable[t],n=Object(i["a"])(Object(i["a"])({},a),{},{status:"ANU"});this.guidesTable.splice(t,1,n)}},beforeMount:function(){this.getGuidesLocal()}},L=S,O=(a("de59"),Object(x["a"])(L,n,r,!1,null,"16ebd102",null));t["default"]=O.exports},"9b93":function(e,t,a){},a434:function(e,t,a){"use strict";var n=a("23e7"),r=a("7b0b"),i=a("23cb"),s=a("5926"),o=a("07fa"),u=a("3511"),c=a("65f0"),d=a("8418"),l=a("083a"),b=a("1dde"),m=b("splice"),f=Math.max,g=Math.min;n({target:"Array",proto:!0,forced:!m},{splice:function(e,t){var a,n,b,m,p,h,v=r(this),y=o(v),D=i(e,y),N=arguments.length;for(0===N?a=n=0:1===N?(a=0,n=y-D):(a=N-2,n=g(f(s(t),0),y-D)),u(y+a-n),b=c(v,n),m=0;m<n;m++)p=D+m,p in v&&d(b,m,v[p]);if(b.length=n,a<n){for(m=D;m<y-n;m++)p=m+n,h=m+a,p in v?v[h]=v[p]:l(v,h);for(m=y;m>y-n+a;m--)l(v,m-1)}else if(a>n)for(m=y-n;m>D;m--)p=m+n-1,h=m+a-1,p in v?v[h]=v[p]:l(v,h);for(m=0;m<a;m++)v[m+D]=arguments[m+2];return v.length=y-n+a,b}})},c54a:function(e,t,a){"use strict";a("9b93")},de59:function(e,t,a){"use strict";a("4296")}}]);
//# sourceMappingURL=chunk-2a385a30.97021d76.js.map