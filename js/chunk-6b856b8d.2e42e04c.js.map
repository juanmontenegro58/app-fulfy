{"version":3,"sources":["webpack:///./node_modules/core-js/internals/delete-property-or-throw.js","webpack:///./src/assets/images/barcode.png","webpack:///./src/api/graphql/query/products.js","webpack:///./src/api/graphql/query/dispatchs.js","webpack:///./node_modules/core-js/modules/es.array.splice.js","webpack:///./src/router/views/inventory/incomeInventory.vue","webpack:///./src/api/graphql/mutations/income.js","webpack:///src/router/views/inventory/incomeInventory.vue","webpack:///./src/router/views/inventory/incomeInventory.vue?62d1","webpack:///./src/router/views/inventory/incomeInventory.vue?1ada"],"names":["tryToString","$TypeError","TypeError","module","exports","O","P","ALL_PRODUCTS_CURRENT_STORE_USER","gql","PRODUCTS_LOW_STOCK","LIST_DISPATCHS","DISPATCHS_RETURNS_BY_STORE","$","toObject","toAbsoluteIndex","toIntegerOrInfinity","lengthOfArrayLike","doesNotExceedSafeInteger","arraySpeciesCreate","createProperty","deletePropertyOrThrow","arrayMethodHasSpeciesSupport","HAS_SPECIES_SUPPORT","max","Math","min","target","proto","forced","splice","start","deleteCount","insertCount","actualDeleteCount","A","k","from","to","this","len","actualStart","argumentsLength","arguments","length","render","_vm","_c","_self","attrs","title","staticClass","loadingProducts","directives","name","rawName","value","returned","expression","domProps","Array","isArray","_i","on","$event","$$a","$$el","$$c","checked","$$v","$$i","concat","slice","_v","ref","loadingPackage","type","indexOf","_k","keyCode","key","getProductsDispatch","addProduct","model","searchSku","callback","productSelected","fields","scopedSlots","_u","fn","item","deleteRecord","sku","_e","loadingCreate","createIncome","require","staticRenderFns","CREATE_INCOME","components","Layout","PageHeader","data","label","allProducts","dataMutation","lastCursor","watch","methods","toast","query","variables","guide","includeStore","includeSku","response","dispatchs","node","product","formatDataTable","quantity","id","formatDataMutation","getProducts","cursor","listProducts","income","mutation","addArrayProducts","incomeDevolutionModal","Swal","html","text","icon","showCancelButton","cancelButtonText","cancelButtonColor","confirmButtonText","showLoaderOnConfirm","preConfirm","buildTextHtml","beforeMount","component"],"mappings":"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","file":"js/chunk-6b856b8d.2e42e04c.js","sourcesContent":["'use strict';\nvar tryToString = require('../internals/try-to-string');\n\nvar $TypeError = TypeError;\n\nmodule.exports = function (O, P) {\n  if (!delete O[P]) throw $TypeError('Cannot delete property ' + tryToString(P) + ' of ' + tryToString(O));\n};\n","module.exports = __webpack_public_path__ + \"img/barcode.0152e02c.png\";","import gql from 'graphql-tag'\n\nconst ALL_PRODUCTS_CURRENT_STORE_USER = gql`query listProducts($cursor: String, $productName: String){\n    listProducts(after: $cursor, name_Icontains: $productName){\n        pageInfo{\n            hasNextPage\n        }\n        edges{\n            cursor\n            node{\n                name\n                id\n                stock\n                price\n                sku\n                store{\n                    name\n                }\n            }\n        }\n    }\n}`\n\nconst PRODUCTS_LOW_STOCK = gql`query productsLowStock($store: Int){\n    productsLowStock(store: $store){\n        stock\n        product\n        store\n        id\n    }\n}`\n\nexport {\n    ALL_PRODUCTS_CURRENT_STORE_USER,\n    PRODUCTS_LOW_STOCK\n}","import gql from 'graphql-tag'\n\nconst LIST_DISPATCHS = gql`query allDispatchs($store: String, $guide: String,\n    $cursor: String, $includeStore: Boolean!, $includeSku: Boolean!, $startDate: DateTime,\n    $endDate: DateTime, $first: Int){\n    dispatchs(store_Name_Iexact: $store, guide_Icontains: $guide after: $cursor,\n        created_Date_Gte: $startDate, created_Date_Lte: $endDate, first: $first){\n        pageInfo{\n            hasNextPage\n        }\n        edges{\n            cursor\n            node{\n                guide\n                created\n                productpackagethroughSet{\n                    product{\n                        name\n                        sku @include(if: $includeSku)\n                        id\n                    }\n                    quantity\n                }\n                store @include(if: $includeStore){\n                    name\n                }\n            }\n        }\n    }\n}`\n\nconst DISPATCHS_RETURNS_BY_STORE = gql`query DispatchsReturns($store: Int, $startDate: Date!, $endDate: Date!){\n    returnsDispatchs(startDate: $startDate, endDate: $endDate, store: $store){\n        dispatchs\n        returns\n        storeName\n        storeId\n    }\n}`\n\nexport {\n    LIST_DISPATCHS,\n    DISPATCHS_RETURNS_BY_STORE\n}","'use strict';\nvar $ = require('../internals/export');\nvar toObject = require('../internals/to-object');\nvar toAbsoluteIndex = require('../internals/to-absolute-index');\nvar toIntegerOrInfinity = require('../internals/to-integer-or-infinity');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar doesNotExceedSafeInteger = require('../internals/does-not-exceed-safe-integer');\nvar arraySpeciesCreate = require('../internals/array-species-create');\nvar createProperty = require('../internals/create-property');\nvar deletePropertyOrThrow = require('../internals/delete-property-or-throw');\nvar arrayMethodHasSpeciesSupport = require('../internals/array-method-has-species-support');\n\nvar HAS_SPECIES_SUPPORT = arrayMethodHasSpeciesSupport('splice');\n\nvar max = Math.max;\nvar min = Math.min;\n\n// `Array.prototype.splice` method\n// https://tc39.es/ecma262/#sec-array.prototype.splice\n// with adding support of @@species\n$({ target: 'Array', proto: true, forced: !HAS_SPECIES_SUPPORT }, {\n  splice: function splice(start, deleteCount /* , ...items */) {\n    var O = toObject(this);\n    var len = lengthOfArrayLike(O);\n    var actualStart = toAbsoluteIndex(start, len);\n    var argumentsLength = arguments.length;\n    var insertCount, actualDeleteCount, A, k, from, to;\n    if (argumentsLength === 0) {\n      insertCount = actualDeleteCount = 0;\n    } else if (argumentsLength === 1) {\n      insertCount = 0;\n      actualDeleteCount = len - actualStart;\n    } else {\n      insertCount = argumentsLength - 2;\n      actualDeleteCount = min(max(toIntegerOrInfinity(deleteCount), 0), len - actualStart);\n    }\n    doesNotExceedSafeInteger(len + insertCount - actualDeleteCount);\n    A = arraySpeciesCreate(O, actualDeleteCount);\n    for (k = 0; k < actualDeleteCount; k++) {\n      from = actualStart + k;\n      if (from in O) createProperty(A, k, O[from]);\n    }\n    A.length = actualDeleteCount;\n    if (insertCount < actualDeleteCount) {\n      for (k = actualStart; k < len - actualDeleteCount; k++) {\n        from = k + actualDeleteCount;\n        to = k + insertCount;\n        if (from in O) O[to] = O[from];\n        else deletePropertyOrThrow(O, to);\n      }\n      for (k = len; k > len - actualDeleteCount + insertCount; k--) deletePropertyOrThrow(O, k - 1);\n    } else if (insertCount > actualDeleteCount) {\n      for (k = len - actualDeleteCount; k > actualStart; k--) {\n        from = k + actualDeleteCount - 1;\n        to = k + insertCount - 1;\n        if (from in O) O[to] = O[from];\n        else deletePropertyOrThrow(O, to);\n      }\n    }\n    for (k = 0; k < insertCount; k++) {\n      O[k + actualStart] = arguments[k + 2];\n    }\n    O.length = len - actualDeleteCount + insertCount;\n    return A;\n  }\n});\n","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('layout',[_c('page-header',{attrs:{\"title\":_vm.title}}),_c('div',[_c('b-card',{staticClass:\"mb-2 text-center\",attrs:{\"title\":\"Ingreso de inventario\"}},[_c('b-card-text',[(_vm.loadingProducts)?[_c('b-skeleton',{attrs:{\"animation\":\"wave\",\"width\":\"85%\"}}),_c('b-skeleton',{attrs:{\"animation\":\"wave\",\"width\":\"55%\"}}),_c('b-skeleton',{attrs:{\"animation\":\"wave\",\"width\":\"70%\"}}),_c('b-skeleton',{attrs:{\"animation\":\"wave\",\"width\":\"55%\"}}),_c('b-skeleton',{attrs:{\"animation\":\"wave\",\"width\":\"85%\"}})]:[_c('div',{staticClass:\"d-grid gap-2 d-md-flex justify-content-md-end\"},[_c('div',{staticClass:\"form-check form-switch form-switch-md mb-3\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.returned),expression:\"returned\"}],staticClass:\"form-check-input\",attrs:{\"type\":\"checkbox\",\"role\":\"switch\",\"id\":\"flexSwitchCheckDefault\"},domProps:{\"checked\":Array.isArray(_vm.returned)?_vm._i(_vm.returned,null)>-1:(_vm.returned)},on:{\"change\":function($event){var $$a=_vm.returned,$$el=$event.target,$$c=$$el.checked?(true):(false);if(Array.isArray($$a)){var $$v=null,$$i=_vm._i($$a,$$v);if($$el.checked){$$i<0&&(_vm.returned=$$a.concat([$$v]))}else{$$i>-1&&(_vm.returned=$$a.slice(0,$$i).concat($$a.slice($$i+1)))}}else{_vm.returned=$$c}}}}),_c('label',{staticClass:\"form-check-label\",attrs:{\"for\":\"flexSwitchCheckDefault\"}},[_vm._v(\" Devolución \")])])]),_c('b-form-group',[_c('b-input-group',[_c('b-form-input',{ref:\"inputGuideSku\",attrs:{\"id\":\"input-1\",\"type\":\"text\",\"placeholder\":_vm.returned ? 'Número de guía': 'SKU',\"required\":\"\",\"autofocus\":\"\",\"disabled\":_vm.loadingPackage},on:{\"keyup\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\"))return null;_vm.returned ?  _vm.getProductsDispatch(): _vm.addProduct()}},model:{value:(_vm.searchSku),callback:function ($$v) {_vm.searchSku=$$v},expression:\"searchSku\"}})],1)],1),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.productSelected.length),expression:\"productSelected.length\"}]},[_c('b-table',{attrs:{\"striped\":\"\",\"hover\":\"\",\"items\":_vm.productSelected,\"fields\":_vm.fields},scopedSlots:_vm._u([(!_vm.returned)?{key:\"cell(actions)\",fn:function({ item }){return [_c('b-btn',{attrs:{\"variant\":\"danger\"},on:{\"click\":function($event){return _vm.deleteRecord(item.sku)}}},[_c('i',{staticClass:\"mdi mdi-delete\"})])]}}:null],null,true)}),(!_vm.returned)?_c('div',{staticClass:\"d-grid gap-2 d-md-flex justify-content-md-end\"},[_c('b-btn',{attrs:{\"variant\":\"success\",\"disabled\":_vm.loadingCreate},on:{\"click\":function($event){return _vm.createIncome()}}},[(_vm.loadingCreate)?[_c('b-spinner',{attrs:{\"small\":\"\",\"type\":\"grow\"}}),_vm._v(\" Cargando... \")]:[_vm._v(\" Finalizar \")]],2)],1):_vm._e()],1),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.productSelected.length),expression:\"!productSelected.length\"}],staticClass:\"mt-2\"},[_c('img',{staticClass:\"img-fluid\",attrs:{\"src\":require(\"@/assets/images/barcode.png\"),\"alt\":\"...\",\"width\":\"300px\"}})])]],2)],1)],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import gql from 'graphql-tag'\n\nconst CREATE_INCOME = gql`mutation createIncome($income: [IncomeInput]!, $returned: ReturnedInput){\n    createIncome(income: $income, returned: $returned){\n        income\n        \n    }\n}`\n\nexport {\n    CREATE_INCOME\n}","<template>\n    <layout>\n      <page-header :title=\"title\"></page-header>\n      <div>\n        <b-card \n          class=\"mb-2 text-center\"\n          title=\"Ingreso de inventario\"\n        >\n          <b-card-text>\n            <template v-if=\"loadingProducts\">\n              <b-skeleton animation=\"wave\" width=\"85%\"></b-skeleton>\n              <b-skeleton animation=\"wave\" width=\"55%\"></b-skeleton>\n              <b-skeleton animation=\"wave\" width=\"70%\"></b-skeleton>\n              <b-skeleton animation=\"wave\" width=\"55%\"></b-skeleton>\n              <b-skeleton animation=\"wave\" width=\"85%\"></b-skeleton>\n            </template>\n            <template v-else>\n              <div class=\"d-grid gap-2 d-md-flex justify-content-md-end\">\n                <div class=\"form-check form-switch form-switch-md mb-3\">\n                  <input \n                    class=\"form-check-input\" \n                    type=\"checkbox\" \n                    role=\"switch\" \n                    id=\"flexSwitchCheckDefault\"\n                    v-model=\"returned\"\n                  >\n                  <label \n                    class=\"form-check-label\" \n                    for=\"flexSwitchCheckDefault\"\n                  >\n                    Devolución\n                  </label>\n                </div>\n              </div>\n              <b-form-group\n              >\n                <b-input-group>\n                  <b-form-input\n                    id=\"input-1\"\n                    v-model=\"searchSku\"\n                    type=\"text\"\n                    :placeholder=\"returned ? 'Número de guía': 'SKU' \"\n                    required\n                    autofocus\n                    :disabled=\"loadingPackage\"\n                    @keyup.enter=\"returned ?  getProductsDispatch(): addProduct()\"\n                    ref=\"inputGuideSku\"\n                  ></b-form-input>\n                </b-input-group>\n              </b-form-group>\n              <div v-show=\"productSelected.length\">\n                <b-table \n                  striped \n                  hover \n                  :items=\"productSelected\" \n                  :fields=\"fields\"\n                >\n                  <template v-slot:cell(actions)=\"{ item }\" v-if=\"!returned\">\n                    <b-btn @click=\"deleteRecord(item.sku)\" variant=\"danger\">\n                      <i class=\"mdi mdi-delete\"></i>\n                    </b-btn>\n                  </template>\n                </b-table>\n                <div \n                  class=\"d-grid gap-2 d-md-flex justify-content-md-end\"\n                  v-if=\"!returned\"\n                >\n                  <b-btn\n                    variant=\"success\"\n                    @click=\"createIncome()\"\n                    :disabled=\"loadingCreate\"\n                  >\n                    <template v-if=\"loadingCreate\">\n                      <b-spinner small type=\"grow\"></b-spinner>\n                      Cargando...\n                    </template>\n                    <template v-else>\n                      Finalizar\n                    </template>\n                  </b-btn>\n                </div>\n              </div>\n              <div class=\"mt-2\" v-show=\"!productSelected.length\">\n                <img class=\"img-fluid\" src=\"@/assets/images/barcode.png\" alt=\"...\" width=\"300px\">\n              </div>\n            </template>\n          </b-card-text>\n        </b-card>\n      </div>\n    </layout>\n</template>\n<script>\nimport Layout from \"../../layouts/main\";\nimport PageHeader from \"@/components/page-header\";\nimport Swal from 'sweetalert2'\nimport { ALL_PRODUCTS_CURRENT_STORE_USER } from '@/api/graphql/query/products'\nimport { CREATE_INCOME } from '@/api/graphql/mutations/income'\nimport { toast } from '@/utils/alerts'\nimport { decode_bs64 } from '@/utils/general'\nimport { LIST_DISPATCHS } from \"../../../api/graphql/query/dispatchs\";\n\nexport default {\n  components: {\n    Layout,\n    PageHeader\n  },\n  data(){\n    return{\n      title: 'Inventario',\n      searchSku: null,\n      fields: [\n        {\n          key: 'name',\n          label: 'Producto'\n        },\n        {\n          key: 'quantity',\n          label: 'Cantidad'\n        },\n        {\n          key: 'actions',\n          label: 'Acciones'\n        }\n      ],\n      allProducts: [],\n      productSelected: [],\n      dataMutation: [],\n      lastCursor: null,\n      returned: false,\n      loadingProducts: true,\n      loadingCreate: false,\n      loadingPackage: false,\n    }\n  },\n  watch: {\n    returned: function(newValue){\n      this.$refs.inputGuideSku.focus()\n      this.productSelected = []\n      this.searchSku = null\n    }\n  },\n  methods: {\n    async getProductsDispatch(){\n      this.loadingPackage = true\n      if (this.searchSku === null){\n        return toast('error', 'Debes ingresar el número de guía')\n      }\n      this.productSelected = []\n      try {\n        const response = await this.$apollo.query({\n          query: LIST_DISPATCHS,\n          variables: {\n            guide: this.searchSku,\n            includeStore: false,\n            includeSku: true\n          }\n        })\n        const { dispatchs } = response.data\n        if (dispatchs !== null){\n          const { node } = dispatchs.edges[0]\n          for (let item of node.productpackagethroughSet){\n            const data = this.formatDataTable(item.product, item.quantity)\n            this.productSelected.push(data)\n          }\n          this.incomeDevolutionModal()\n        }else{\n          toast('error', 'No se pudo recuperar la información')\n        }\n      } catch (error) {\n        toast('error', 'No se pudo recuperar la información')\n      }\n      this.loadingPackage = false\n    },\n    addProduct(){\n      const index =   this.allProducts.findIndex( product => product.sku === this.searchSku)\n      if (index === -1){\n        toast('error', 'El producto no se ha encontrado')\n      }else{\n        const indexs = this.productSelected.findIndex( product => product.sku === this.searchSku)\n        if (indexs !== -1){\n          const product = this.productSelected[indexs]\n          product.quantity += 1\n        }else{\n          this.productSelected.push(this.formatDataTable(this.allProducts[index]))\n        }\n      }\n      this.searchSku = null\n    },\n    formatDataTable(data, quantity = 1){\n      const idInt = decode_bs64( data.id ).split(':')[1]\n      const temp = {\n        name: data.name,\n        quantity: quantity,\n        sku: data.sku,\n        id: idInt\n      }\n      return temp\n    },\n    formatDataMutation(){\n      for (let product of this.productSelected){\n        const temp = {\n          quantity: product.quantity,\n          product: product.id,\n          returned: this.returned\n        }\n        this.dataMutation.push(temp)\n      }\n    },\n    deleteRecord(sku){\n      const index = this.productSelected.findIndex(product => product.sku === sku)\n      if (index !== -1){\n        this.productSelected.splice(index, 1)\n      }\n    },\n    async getProducts(){\n      try { \n        const response = await this.$apollo.query({\n          query: ALL_PRODUCTS_CURRENT_STORE_USER,\n          variables: {\n            cursor: this.lastCursor,\n          }\n        })\n        const { listProducts } = response.data\n        if (listProducts !== null){\n          const data = listProducts.edges\n          this.hasNextPage = listProducts.pageInfo.hasNextPage\n          this.addArrayProducts(data)\n          if (this.hasNextPage){\n            this.getProducts()\n          }else{\n            this.loadingProducts = false\n          }\n        }else{\n          toast('error', 'No se pudo recuperar la información')\n          this.loadingProducts = false\n        }\n      } catch (error) {\n        this.loadingProducts = false\n        toast('error', 'No se pudo recuperar la información')\n      }\n    },\n    async createIncome(){\n      this.loadingCreate = true\n      this.formatDataMutation()\n      const variables = {\n        income: this.dataMutation\n      }\n      if (this.returned === true){\n        variables['returned'] = {\n          'returned': this.returned,\n          'guide': this.searchSku\n        }\n      }\n      try {\n        const response = await this.$apollo.mutate({\n          mutation: CREATE_INCOME,\n          variables: variables\n        })\n        const { createIncome } = response.data\n        if (createIncome !== null){\n          const { income } = createIncome\n          if (income === true){\n            toast('success', 'El ingreso se realizo correctamente')\n            this.productSelected = []\n            this.dataMutation = []\n          }else{\n            toast('error', 'No se pudo realizar el ingreso')\n          }\n        }else{\n          toast('error', 'No se pudo realizar el ingreso')\n        }\n        this.loadingCreate = false\n      } catch (error) {\n        this.loadingCreate = false\n        toast('error', 'No se pudo realizar el ingreso')\n      }\n      this.searchSku = null\n      this.$refs.inputGuideSku.focus()\n    },\n    addArrayProducts(data){\n      for (let product of data){\n        const { node } = product\n        const temp = {\n          id: node.id,\n          name: node.name,\n          sku: node.sku\n        }\n        this.allProducts.push(temp)\n        this.lastCursor = product.cursor\n      }\n    },\n    incomeDevolutionModal(){\n      const text = this.buildTextHtml()\n      Swal.fire({\n        title: '¿Estas seguro?',\n        html: `<div class=\"text-center\">\n          <h6>Estas seguro de crear devolución para el número de guía <strong>${this.searchSku}</strong> con los siguientes productos.</h6>\n        </div>\n        <div class=\"row\">\n          ${text}\n        </div>`,\n        icon: 'question',\n        showCancelButton: true,\n        cancelButtonText: 'No, cancelar',\n        cancelButtonColor: '#bb2d3b',\n        confirmButtonText: 'Si, guardar',\n        showLoaderOnConfirm: true,\n        preConfirm: () => {\n          return this.createIncome()\n        }\n      })\n    },\n    buildTextHtml(){\n      let text = ''\n      for (let item of this.productSelected){\n        text += `<div class=\"col-md-6\">\n            <div class=\"card\">\n              <div class=\"card-body\">\n                <p class=\"card-text\">\n                  <strong>${item.name}:</strong> ${item.quantity}\n                </p>\n              </div>\n            </div>\n          </div>`\n      }\n      return text\n    },\n  },\n  beforeMount(){\n    this.getProducts()\n  }\n}\n</script>","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./incomeInventory.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./incomeInventory.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./incomeInventory.vue?vue&type=template&id=1d98071d&\"\nimport script from \"./incomeInventory.vue?vue&type=script&lang=js&\"\nexport * from \"./incomeInventory.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}