(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8e64725e"],{"129f":function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t===1/e:t!=t&&e!=e}},"6f58":function(t,e,a){"use strict";a.r(e);a("ac1f"),a("841c"),a("b0c0");var n=function(){var t=this,e=t._self._c;return e("layout",[e("page-header",{attrs:{title:t.title}}),[e("div",[e("b-card",{staticClass:"mb-2"},[e("b-card-text",[e("b-row",[e("b-col",{attrs:{md:"4"}},[e("b-form-group",{staticClass:"mb-2"},[e("b-form-datepicker",{attrs:{placeholder:"Fecha Inicial",max:t.maxDate},model:{value:t.startDate,callback:function(e){t.startDate=e},expression:"startDate"}})],1)],1),e("b-col",{attrs:{md:"4"}},[e("b-form-group",{staticClass:"mb-2"},[e("b-form-datepicker",{attrs:{placeholder:"Fecha Final",max:t.maxDate,min:t.minEndDate},model:{value:t.endDate,callback:function(e){t.endDate=e},expression:"endDate"}})],1)],1),e("b-col",{attrs:{md:"1"}},[e("b-button",{attrs:{disabled:null===t.startDate||null===t.endDate,variant:"success"},on:{click:function(e){return t.getDispatchs(!0)}}},[t._v(" Enviar ")])],1),e("b-col",{attrs:{md:"1"}},[e("b-button",{directives:[{name:"show",rawName:"v-show",value:t.startDate&&t.endDate,expression:"startDate && endDate"}],attrs:{variant:"info"},on:{click:function(e){return t.clearDates()}}},[t._v(" Limpiar ")])],1)],1),e("b-col",{attrs:{lg:"4",md:"4"}},[e("b-form",{staticClass:"mb-3",on:{submit:function(t){t.preventDefault()}}},[e("b-form-group",[e("b-input-group",[e("b-form-input",{attrs:{id:"input-1",type:"text",placeholder:"Buscar por número de guía",required:""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}}),e("b-input-group-append",[e("b-button",{attrs:{type:"submit",disabled:!t.search,variant:"warning"},on:{click:function(e){return t.getDispatchs(!0)}}},[t._v("Buscar")])],1)],1)],1)],1)],1),t.loadingDispatchs?[e("b-skeleton-table",{attrs:{rows:10,columns:4,"table-props":{bordered:!0,striped:!0}}})]:[e("div",{staticClass:"table-responsive"},[e("b-table",{attrs:{striped:"",hover:"",items:t.dispatchsTable,fields:t.fields,responsive:"sm"},scopedSlots:t._u([{key:"cell(actions)",fn:function(a){var n=a.item;return[e("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-lg",modifiers:{"modal-lg":!0}}],attrs:{variant:"primary"},on:{click:function(e){return t.searchDispatch(n.guide)}}},[e("i",{staticClass:"mdi mdi-eye"})])]}}])})],1)]],2)],1),t.hasNextPage?e("div",{staticClass:"text-center mt-2"},[e("b-button",{attrs:{block:"",variant:"primary",disabled:t.loadingMore},on:{click:function(e){return t.getDispatchs()}}},[t.loadingMore?[e("b-spinner",{attrs:{small:"",type:"grow"}}),t._v(" Cargando... ")]:[t._v(" Ver más ")]],2)],1):t._e()],1),t.dispatchSelected?e("b-modal",{attrs:{id:"modal-lg",size:"lg",title:"Despacho ".concat(t.dispatchSelected.guide),"no-close-on-backdrop":!0,"no-close-on-esc":!0}},[e("b-row",t._l(t.dispatchSelected.products,(function(a,n){return e("div",{key:n,staticClass:"col-md-6"},[e("b-card",[e("b-card-text",[e("strong",[t._v(t._s(a.product.name)+":")]),t._v(" "+t._s(a.quantity)+" ")])],1)],1)})),0)],1):t._e()]],2)},s=[],r=a("b85c"),i=a("c7eb"),c=a("1da1"),o=(a("c740"),a("444f")),l=a("2579"),u=a("9323"),d=a("9b8d"),h=a("154f"),p={components:{Layout:o["a"],PageHeader:l["a"]},data:function(){var t=new Date,e=new Date(t.getFullYear(),t.getMonth(),t.getDate());return{title:"Despachos",loadingDispatchs:!0,loadingMore:!1,hasNextPage:null,lastCursor:null,dispatchsTable:[],guideNumber:null,search:null,startDate:null,endDate:null,maxDate:e,minEndDate:null,fields:[{key:"guide",label:"Guía"},{key:"store",label:"Tienda"},{key:"products",label:"Productos"},{key:"created",label:"Fecha despacho"},{key:"actions",label:"Acciones"}],dispatchsDetail:[],dispatchSelected:null}},watch:{search:function(t){""===t&&(this.dispatchsTable=[],this.lastCursor=null,this.getDispatchs(),this.loadingDispatchs=!0)},startDate:function(t){this.startDate>this.endDate&&(this.endDate=this.startDate);var e=new Date(this.startDate),a=new Date(e.getFullYear(),e.getMonth(),e.getDate()+1);this.minEndDate=a}},methods:{getDispatchs:function(){var t=arguments,e=this;return Object(c["a"])(Object(i["a"])().mark((function a(){var n,s,r,c;return Object(i["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=t.length>0&&void 0!==t[0]&&t[0],!0===n&&(e.loadingDispatchs=!0,e.dispatchsTable=[],e.lastCursor=null),e.loadingMore=!0,a.prev=3,a.next=6,e.$apollo.query({query:u["b"],variables:{cursor:e.lastCursor,guide:e.search,includeStore:!0,includeSku:!1,startDate:null!==e.startDate?new Date(e.startDate):null,endDate:null!==e.endDate?new Date(e.endDate):null}});case 6:s=a.sent,r=s.data.dispatchs,null!==r?(c=r.edges,e.hasNextPage=r.pageInfo.hasNextPage,e.formatDataTable(c)):Object(d["b"])("error","No se pudo recuperar la información"),e.loadingDispatchs=!1,e.loadingMore=!1,a.next=18;break;case 13:a.prev=13,a.t0=a["catch"](3),e.loadingDispatchs=!1,e.loadingMore=!1,Object(d["b"])("error","No se pudo recuperar la información");case 18:case"end":return a.stop()}}),a,null,[[3,13]])})))()},formatDataTable:function(t){var e,a=Object(r["a"])(t);try{for(a.s();!(e=a.n()).done;){var n=e.value,s={guide:n.node.guide,store:n.node.store.name,created:Object(h["d"])(n.node.created),products:this.sumQuantityProducts(n.node.productpackagethroughSet)},i={guide:n.node.guide,products:n.node.productpackagethroughSet};this.dispatchsTable.push(s),this.dispatchsDetail.push(i),this.lastCursor=n.cursor}}catch(c){a.e(c)}finally{a.f()}},sumQuantityProducts:function(t){var e,a=0,n=Object(r["a"])(t);try{for(n.s();!(e=n.n()).done;){var s=e.value;a+=s.quantity}}catch(i){n.e(i)}finally{n.f()}return a},searchDispatch:function(t){var e=this.dispatchsDetail.findIndex((function(e){return e.guide===t}));-1!==e&&(this.dispatchSelected=this.dispatchsDetail[e])},clearDates:function(){this.startDate=null,this.endDate=null,this.dispatchsTable=[],this.lastCursor=null,this.hasNextPage=null,this.loadingDispatchs=!0,this.getDispatchs()}},beforeMount:function(){this.getDispatchs()}},b=p,D=a("2877"),g=Object(D["a"])(b,n,s,!1,null,null,null);e["default"]=g.exports},"841c":function(t,e,a){"use strict";var n=a("c65b"),s=a("d784"),r=a("825a"),i=a("1d80"),c=a("129f"),o=a("577e"),l=a("dc4a"),u=a("14c3");s("search",(function(t,e,a){return[function(e){var a=i(this),s=void 0==e?void 0:l(e,t);return s?n(s,e,a):new RegExp(e)[t](o(a))},function(t){var n=r(this),s=o(t),i=a(e,n,s);if(i.done)return i.value;var l=n.lastIndex;c(l,0)||(n.lastIndex=0);var d=u(n,s);return c(n.lastIndex,l)||(n.lastIndex=l),null===d?-1:d.index}]}))},9323:function(t,e,a){"use strict";a.d(e,"b",(function(){return c})),a.d(e,"a",(function(){return o}));var n,s,r=a("8785"),i=a("5184"),c=Object(i["a"])(n||(n=Object(r["a"])(["query allDispatchs($store: String, $guide: String,\n    $cursor: String, $includeStore: Boolean!, $includeSku: Boolean!, $startDate: DateTime,\n    $endDate: DateTime, $first: Int){\n    dispatchs(store_Name_Iexact: $store, guide_Icontains: $guide after: $cursor,\n        created_Date_Gte: $startDate, created_Date_Lte: $endDate, first: $first){\n        pageInfo{\n            hasNextPage\n        }\n        edges{\n            cursor\n            node{\n                guide\n                created\n                productpackagethroughSet{\n                    product{\n                        name\n                        sku @include(if: $includeSku)\n                        id\n                    }\n                    quantity\n                }\n                store @include(if: $includeStore){\n                    name\n                }\n            }\n        }\n    }\n}"]))),o=Object(i["a"])(s||(s=Object(r["a"])(["query DispatchsReturns($store: Int, $startDate: Date!, $endDate: Date!){\n    returnsDispatchs(startDate: $startDate, endDate: $endDate, store: $store){\n        dispatchs\n        returns\n        storeName\n        storeId\n    }\n}"])))}}]);
//# sourceMappingURL=chunk-8e64725e.846a0ef7.js.map