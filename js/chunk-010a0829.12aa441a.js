(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-010a0829"],{"0afc":function(t,e,a){"use strict";a.r(e);var r,s,n=function(){var t=this,e=t._self._c;return e("Layout",[e("PageHeader",{attrs:{title:t.title}}),t.can("view_report_product")?[e("b-row",[e("b-col",{attrs:{md:"4"}},[e("b-form-group",{staticClass:"mb-2"},[e("b-form-datepicker",{attrs:{placeholder:"Fecha Inicial",max:t.maxDate,"today-button":""},model:{value:t.startDate,callback:function(e){t.startDate=e},expression:"startDate"}})],1)],1),e("b-col",{attrs:{md:"4"}},[e("b-form-group",{staticClass:"mb-2"},[e("b-form-datepicker",{attrs:{placeholder:"Fecha Final",max:t.maxDate,min:t.minEndDate,"today-button":""},model:{value:t.endDate,callback:function(e){t.endDate=e},expression:"endDate"}})],1)],1),e("b-col",{attrs:{md:"1"}},[e("b-button",{attrs:{variant:"primary",disabled:t.disabledButtonSend},on:{click:function(e){return t.getDataReports()}}},[t.loadingReports?[e("b-spinner",{attrs:{small:""}})]:[t._v(" Enviar ")]],2)],1),e("b-col",{attrs:{md:"1"}},[e("b-button",{directives:[{name:"show",rawName:"v-show",value:t.startDate&&t.endDate,expression:"startDate && endDate"}],attrs:{variant:"info"},on:{click:function(e){return t.clear()}}},[t._v(" Limpiar ")])],1)],1),e("div",{staticClass:"row"},[e("b-col",{attrs:{md:"12"}},[e("div",{staticClass:"row"},t._l(t.statData,(function(t){return e("div",{key:t.icon,staticClass:"col-md-4"},[e("Stat",{attrs:{icon:t.icon,title:t.title,value:t.value,hasData:t.hasData,percent:t.percent}})],1)})),0)]),t.expenseChartData?e("b-col",{attrs:{md:"12"}},[e("b-card",{attrs:{title:"Egresos por tienda"}},[e("b-card-text",[e("apexchart",{staticClass:"apex-charts",attrs:{height:"350",type:"bar",dir:"ltr",series:t.expenseChart.series,options:t.expenseChart.chartOptions},on:{click:t.handleClickExpenseChart}})],1)],1)],1):t._e(),t.expenseProductChartData?e("b-col",{attrs:{md:"12"}},[e("b-card",{attrs:{title:"Egresos por producto"}},[e("b-card-text",[e("apexchart",{staticClass:"apex-charts",attrs:{height:"350",type:"bar",dir:"ltr",series:t.expenseProductChart.series,options:t.expenseProductChart.chartOptions}})],1)],1)],1):t._e(),t.returnsDispatchsChartData?e("b-col",{attrs:{md:"12"}},[e("b-card",{attrs:{title:"Devoluciones y despachos"}},[e("b-card-text",[e("apexchart",{staticClass:"apex-charts",attrs:{height:"350",type:"bar",dir:"ltr",series:t.returnsDispatchsChart.series,options:t.returnsDispatchsChart.chartOptions}})],1)],1)],1):t._e(),e("div",{staticClass:"col-lg-12"},[e("div",{staticClass:"card"},[e("div",{staticClass:"card-body"},[e("h4",{staticClass:"card-title mb-4"},[t._v("Productos bajos de inventario")]),e("products-low-stock",{attrs:{products:t.products,updating:t.fetchingStats}})],1)])])],1)]:t._e()],2)},o=[],i=a("b85c"),c=a("5530"),u=a("c7eb"),d=a("1da1"),l=(a("a4d3"),a("e01a"),a("d3b7"),a("25f0"),a("c740"),function(){var t=this,e=t._self._c;return t.hasData?e("div",{staticClass:"card mini-stats-wid"},[e("div",{staticClass:"card-body"},[e("div",{staticClass:"d-flex"},[e("div",{staticClass:"flex-grow-1"},[e("p",{staticClass:"text-muted fw-medium mb-2"},[t._v(t._s(t.title))]),e("h4",{staticClass:"mb-0"},[t._v(t._s(t.value)+" "),e("span",{staticClass:"badge bg-danger font-size-12"},[t._v(t._s(t.percent))])])]),e("div",{staticClass:"avatar-sm align-self-center mini-stat-icon rounded-circle bg-primary"},[e("span",{staticClass:"avatar-title"},[e("i",{class:"".concat(t.icon," font-size-24")})])])])])]):t._e()}),p=[],h={props:{title:{type:String,default:""},value:{type:String,default:""},icon:{type:String,default:""},hasData:{type:Boolean,default:!1},percent:{type:String,default:""}}},b=h,D=a("2877"),f=Object(D["a"])(b,l,p,!1,null,null,null),v=f.exports,x=a("9475"),m=a("444f"),g=a("c2a4"),y=a("2579"),C=function(){var t=this,e=t._self._c;return e("div",[t.updating?[e("b-skeleton-table",{attrs:{rows:10,columns:4,"table-props":{bordered:!0,striped:!0}}})]:[e("div",{staticClass:"table-responsive mb-0"},[e("table",{staticClass:"table align-middle table-nowrap"},[t._m(0),e("tbody",t._l(t.products,(function(a){return e("tr",{key:a.id},[e("td",[t._v(t._s(a.product))]),e("td",[t._v(t._s(a.stock))]),e("td",[t._v(t._s(a.store))])])})),0)])])]],2)},O=[function(){var t=this,e=t._self._c;return e("thead",{staticClass:"table-light"},[e("tr",[e("th",{staticClass:"align-middle"},[t._v("Producto")]),e("th",{staticClass:"align-middle"},[t._v("Unidades")]),e("th",{staticClass:"align-middle"},[t._v("Tienda")])])])}],S={props:{products:{type:Array,default:function(){return[]}},updating:{type:Boolean}}},j=S,w=Object(D["a"])(j,C,O,!1,null,null,null),_=w.exports,$=a("8fbd"),k=a("8785"),P=a("5184"),B=Object(P["a"])(r||(r=Object(k["a"])(["query reportExpense($store: Int, $startDate: Date!, $endDate: Date!){\n    expenseByStore(store: $store, startDate: $startDate, endDate: $endDate){\n        count\n        storeName\n        storeId\n    }\n}"]))),I=Object(P["a"])(s||(s=Object(k["a"])(["query expenseProduct($store: Int!, $startDate: Date!, $endDate: Date!){\n    expenseByProducts(store: $store, startDate: $startDate, endDate: $endDate){\n        productName\n        count\n        id\n    }\n}"]))),E=a("9323"),N=a("4931"),q=a("9b8d"),R={mixins:[x["a"]],page:{title:"Dashboard",meta:[{name:"description",content:g.description}]},components:{Layout:m["a"],PageHeader:y["a"],ProductsLowStock:_,Stat:v},data:function(){var t=new Date,e=new Date(t.getFullYear(),t.getMonth(),t.getDate());return{s:null,title:"Dashboard",products:[],fetchingStats:!0,loadingReports:!1,startDate:null,endDate:null,expenseChartData:!1,expenseProductChartData:!1,returnsDispatchsChartData:!1,maxDate:e,minEndDate:null,allStores:[],expenseChart:{series:[{data:[]}],chartOptions:{chart:{toolbar:{show:!1}},plotOptions:{bar:{horizontal:!0}},dataLabels:{enabled:!1},colors:["#34c38f"],grid:{borderColor:"#f1f1f1"},xaxis:{categories:[]}}},returnsDispatchsChart:{series:[{name:"Despachos",data:[]},{name:"Egresos",data:[]}],chartOptions:{chart:{toolbar:{show:!1}},plotOptions:{bar:{horizontal:!1,columnWidth:"45%",endingShape:"rounded"}},dataLabels:{enabled:!1},stroke:{show:!0,width:2,colors:["transparent"]},colors:["#34c38f","#556ee6"],xaxis:{categories:[]},grid:{borderColor:"#f1f1f1"},fill:{opacity:1}}},expenseProductChart:{series:[{name:"Unidades",data:[]}],chartOptions:{chart:{toolbar:{show:!1}},plotOptions:{bar:{dataLabels:{position:"top"}}},dataLabels:{enabled:!0,offsetY:-22,style:{fontSize:"12px",colors:["#304758"]}},colors:["#556ee6"],grid:{borderColor:"#f1f1f1"},xaxis:{categories:[],position:"top",labels:{offsetY:-18},axisBorder:{show:!1},axisTicks:{show:!1},crosshairs:{fill:{type:"gradient",gradient:{colorFrom:"#D8E3F0",colorTo:"#BED1E6",stops:[0,100],opacityFrom:.4,opacityTo:.5}}},tooltip:{enabled:!0,offsetY:-35}},fill:{gradient:{shade:"light",type:"horizontal",shadeIntensity:.25,gradientToColors:void 0,inverseColors:!0,opacityFrom:1,opacityTo:1,stops:[50,0,100,100]}},yaxis:{axisBorder:{show:!1},axisTicks:{show:!1},labels:{show:!1}}}},statData:[{icon:"bx bx-copy-alt",title:"Total de productos",value:"Sin información",hasData:!1},{icon:"bx bx-archive-in",title:"Total de despachos",value:"Sin información",hasData:!1},{icon:"bx bx-purchase-tag-alt",title:"Total de devoluciones",value:"Sin información",hasData:!1}],expenseByStoreId:[],returnsDispatchsStoreId:[]}},watch:{startDate:function(t){this.startDate>this.endDate&&(this.endDate=this.startDate);var e=new Date(this.startDate),a=new Date(e.getFullYear(),e.getMonth(),e.getDate()+1);this.minEndDate=a}},computed:{disabledButtonSend:function(){return!(null!==this.startDate&&null!==this.endDate&&!this.loadingReports)&&(this.loadingReports,!0)}},methods:{calculatePercen:function(t,e){return Math.round(100*e/t)},handleClickExpenseChart:function(t,e,a){var r=a.dataPointIndex;if(-1!==r){var s=this.expenseByStoreId[r];this.getExpenseByProduct(s),this.newDataByStore(s)}},getProducts:function(){var t=this;return Object(d["a"])(Object(u["a"])().mark((function e(){var a,r;return Object(u["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$apollo.query({query:$["b"]});case 3:a=e.sent,r=a.data.productsLowStock,null!==r?t.products=r:Object(q["b"])("error","No se pudo recuperar la información"),t.fetchingStats=!1,e.next=13;break;case 9:e.prev=9,e.t0=e["catch"](0),t.fetchingStats=!1,Object(q["b"])("error","No se pudo recuperar la información");case 13:case"end":return e.stop()}}),e,null,[[0,9]])})))()},getDataReports:function(){var t=this;return Object(d["a"])(Object(u["a"])().mark((function e(){return Object(u["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.loadingReports=!0,t.expenseByStoreId=[],t.returnsDispatchsStoreId=[],e.next=5,t.getExpenseByStore();case 5:return e.next=7,t.getDispatchsAndReturns();case 7:t.loadingReports=!1;case 8:case"end":return e.stop()}}),e)})))()},updateExpenseChart:function(t,e){this.expenseChart.series=t,this.expenseChart.chartOptions=Object(c["a"])(Object(c["a"])({},this.expenseChart.chartOptions),{xaxis:{categories:e}})},updateReturnsDispatchsChart:function(t,e){this.returnsDispatchsChart.series=t,this.returnsDispatchsChart.chartOptions=Object(c["a"])(Object(c["a"])({},this.returnsDispatchsChart.chartOptions),{xaxis:{categories:e}})},updateExpenseChartByProduct:function(t,e){this.expenseProductChart.series=t,this.expenseProductChart.chartOptions=Object(c["a"])(Object(c["a"])({},this.expenseProductChart.chartOptions),{xaxis:{categories:e}})},getExpenseByStore:function(){var t=this;return Object(d["a"])(Object(u["a"])().mark((function e(){var a,r;return Object(u["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.expenseProductChartData=!1,e.prev=1,e.next=4,t.$apollo.query({query:B,variables:{startDate:t.startDate,endDate:t.endDate}});case 4:a=e.sent,r=a.data.expenseByStore,null!==r?(t.formatDataExpense(r),t.sumProducts(r)):Object(q["b"])("error","No se pudo recuperar la información de egresos"),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](1),Object(q["b"])("error","No se pudo recuperar la información de egresos");case 12:case"end":return e.stop()}}),e,null,[[1,9]])})))()},getDispatchsAndReturns:function(){var t=this;return Object(d["a"])(Object(u["a"])().mark((function e(){var a,r;return Object(u["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$apollo.query({query:E["a"],variables:{startDate:t.startDate,endDate:t.endDate}});case 3:a=e.sent,r=a.data.returnsDispatchs,null!==r?(t.sumDispatchsAndReturns(r),t.formatDataDispatchsReturns(r)):Object(q["b"])("error","No se pudo recuperar la información de devoluciones y despachos"),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),Object(q["b"])("error","No se pudo recuperar la información de devoluciones y despachos");case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))()},getExpenseByProduct:function(t){var e=this;return Object(d["a"])(Object(u["a"])().mark((function a(){var r,s;return Object(u["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,e.$apollo.query({query:I,variables:{startDate:e.startDate,endDate:e.endDate,store:t}});case 3:r=a.sent,s=r.data.expenseByProducts,null!==s?e.formatDataExpenseByProduct(s):Object(q["b"])("error","No se pudo recuperar la información de egresos por producto"),a.next=11;break;case 8:a.prev=8,a.t0=a["catch"](0),Object(q["b"])("error","No se pudo recuperar la información de egresos por producto");case 11:case"end":return a.stop()}}),a,null,[[0,8]])})))()},formatDataDispatchsReturns:function(t){var e,a={name:"Despachos",data:[]},r={name:"Devoluciones",data:[]},s=[],n=Object(i["a"])(t);try{for(n.s();!(e=n.n()).done;){var o=e.value;a.data.push(o.dispatchs),r.data.push(o.returns),s.push(o.storeName),this.returnsDispatchsStoreId.push(o.storeId)}}catch(u){n.e(u)}finally{n.f()}var c=[];c.push(a),c.push(r),this.updateReturnsDispatchsChart(c,s),this.returnsDispatchsChartData=!0},formatDataExpense:function(t){var e,a=[{name:"Unidades",data:[]}],r=[],s=Object(i["a"])(t);try{for(s.s();!(e=s.n()).done;){var n=e.value;a[0].data.push(n.count),r.push(n.storeName),this.expenseByStoreId.push(n.storeId)}}catch(o){s.e(o)}finally{s.f()}this.updateExpenseChart(a,r),this.expenseChartData=!0},formatDataExpenseByProduct:function(t){var e,a=[{name:"Unidades",data:[]}],r=[],s=Object(i["a"])(t);try{for(s.s();!(e=s.n()).done;){var n=e.value;a[0].data.push(n.count),r.push(n.productName)}}catch(o){s.e(o)}finally{s.f()}this.updateExpenseChartByProduct(a,r),this.expenseProductChartData=!0},sumProducts:function(t){var e,a=0,r=Object(i["a"])(t);try{for(r.s();!(e=r.n()).done;){var s=e.value;a+=s.count}}catch(n){r.e(n)}finally{r.f()}this.statData[0].value=a.toString(),this.statData[0].hasData=!0},sumDispatchsAndReturns:function(t){var e,a=0,r=0,s=Object(i["a"])(t);try{for(s.s();!(e=s.n()).done;){var n=e.value;a+=n.dispatchs,r+=n.returns}}catch(o){s.e(o)}finally{s.f()}this.statData[1].value=a.toString(),this.statData[1].hasData=!0,this.statData[2].value=r.toString(),this.statData[2].hasData=!0,this.statData[2].percent="".concat(this.calculatePercen(a,r),"%")},getAllStores:function(){var t=this;return Object(d["a"])(Object(u["a"])().mark((function e(){var a,r;return Object(u["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$apollo.query({query:N["a"]});case 3:a=e.sent,r=a.data.allStores,null!==r&&(t.allStores=r.edges),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),Object(q["b"])("error","");case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))()},clear:function(){this.startDate=this.endDate=null,this.updateExpenseChart([],[]),this.updateReturnsDispatchsChart([],[]),this.updateExpenseChartByProduct([],[]),this.expenseChartData=!1,this.returnsDispatchsChartData=!1,this.expenseProductChartData=!1;var t,e=Object(i["a"])(this.statData);try{for(e.s();!(t=e.n()).done;){var a=t.value;a.hasData=!1}}catch(r){e.e(r)}finally{e.f()}},newDataByStore:function(t){var e=this.expenseByStoreId.findIndex((function(e){return e===t}));this.statData[0].value=this.expenseChart.series[0].data[e].toString();var a=this.returnsDispatchsStoreId.findIndex((function(e){return e===t}));-1===a&&(this.statData[1].value="0",this.statData[2].value="0",this.statData[2].percent="0%");var r=this.returnsDispatchsChart.series[0].data[a],s=this.returnsDispatchsChart.series[1].data[a];this.statData[1].value=r.toString(),this.statData[2].value=s.toString(),this.statData[2].percent="".concat(this.calculatePercen(r,s),"%")}},beforeMount:function(){this.can("view_report_product")&&(this.getProducts(),this.getAllStores())}},L=R,T=Object(D["a"])(L,n,o,!1,null,null,null);e["default"]=T.exports},4931:function(t,e,a){"use strict";a.d(e,"b",(function(){return i})),a.d(e,"a",(function(){return c}));var r,s,n=a("8785"),o=a("5184"),i=Object(o["a"])(r||(r=Object(n["a"])(["query listStore{\n    allStoresUser{\n        pageInfo{\n            hasNextPage\n        }\n        edges{\n            cursor\n            node{\n                name\n                id\n            }\n        }\n    }\n}"]))),c=Object(o["a"])(s||(s=Object(n["a"])(["query stores{\n    allStores{\n        edges{\n            node{\n                name\n                id\n            }\n        }\n    }\n}"])))},"8fbd":function(t,e,a){"use strict";a.d(e,"a",(function(){return i})),a.d(e,"b",(function(){return c}));var r,s,n=a("8785"),o=a("5184"),i=Object(o["a"])(r||(r=Object(n["a"])(["query listProducts($cursor: String, $productName: String){\n    listProducts(after: $cursor, name_Icontains: $productName){\n        pageInfo{\n            hasNextPage\n        }\n        edges{\n            cursor\n            node{\n                name\n                id\n                stock\n                price\n                sku\n                store{\n                    name\n                }\n            }\n        }\n    }\n}"]))),c=Object(o["a"])(s||(s=Object(n["a"])(["query productsLowStock($store: Int){\n    productsLowStock(store: $store){\n        stock\n        product\n        store\n        id\n    }\n}"])))},9323:function(t,e,a){"use strict";a.d(e,"b",(function(){return i})),a.d(e,"a",(function(){return c}));var r,s,n=a("8785"),o=a("5184"),i=Object(o["a"])(r||(r=Object(n["a"])(["query allDispatchs($store: String, $guide: String,\n    $cursor: String, $includeStore: Boolean!, $includeSku: Boolean!, $startDate: DateTime,\n    $endDate: DateTime, $first: Int){\n    dispatchs(store_Name_Iexact: $store, guide_Icontains: $guide after: $cursor,\n        created_Date_Gte: $startDate, created_Date_Lte: $endDate, first: $first){\n        pageInfo{\n            hasNextPage\n        }\n        edges{\n            cursor\n            node{\n                guide\n                created\n                productpackagethroughSet{\n                    product{\n                        name\n                        sku @include(if: $includeSku)\n                        id\n                    }\n                    quantity\n                }\n                store @include(if: $includeStore){\n                    name\n                }\n            }\n        }\n    }\n}"]))),c=Object(o["a"])(s||(s=Object(n["a"])(["query DispatchsReturns($store: Int, $startDate: Date!, $endDate: Date!){\n    returnsDispatchs(startDate: $startDate, endDate: $endDate, store: $store){\n        dispatchs\n        returns\n        storeName\n        storeId\n    }\n}"])))}}]);
//# sourceMappingURL=chunk-010a0829.12aa441a.js.map